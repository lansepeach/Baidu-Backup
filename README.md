# Baidu-Backupï¼šé«˜æ€§èƒ½ç™¾åº¦ç½‘ç›˜è‡ªåŠ¨å¤‡ä»½ä¸è½®æ›¿è§£å†³æ–¹æ¡ˆ

**Baidu-Backup** æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ã€ç»è¿‡å®æˆ˜è€ƒéªŒçš„è‡ªåŠ¨åŒ–å¤‡ä»½è§£å†³æ–¹æ¡ˆã€‚å®ƒé€šè¿‡ä¸€ä¸ªé«˜åº¦ä¼˜åŒ–çš„ `Shell` è„šæœ¬å’Œ `Python` å¼•æ“ååŒå·¥ä½œï¼Œå°†æ‚¨çš„æœåŠ¡å™¨æ•°æ®ä»¥**é«˜æ€§èƒ½å¹¶è¡Œ**çš„æ–¹å¼ï¼Œè‡ªåŠ¨å¤‡ä»½åˆ°ç™¾åº¦ç½‘ç›˜ï¼Œå¹¶æ™ºèƒ½åœ°ç®¡ç†å†å²å¤‡ä»½ï¼Œå®ç°çœŸæ­£çš„â€œä¸€åŠ³æ°¸é€¸â€ã€‚

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

---

## ğŸš€ ä¸ºä»€ä¹ˆé€‰æ‹© Baidu-Backupï¼Ÿ

æˆ‘ä»¬ä¸ä»…ä»…æ˜¯ä¸€ä¸ªä¸Šä¼ è„šæœ¬ï¼Œæˆ‘ä»¬æ˜¯ä¸€ä¸ª**å®Œæ•´çš„ã€ç”Ÿäº§çº§åˆ«çš„è‡ªåŠ¨åŒ–è¿ç»´è§£å†³æ–¹æ¡ˆ**ï¼Œä¸“ä¸ºè§£å†³çœŸå®ä¸–ç•Œä¸­çš„å¤æ‚é—®é¢˜è€Œè®¾è®¡ï¼š

-   **æè‡´æ€§èƒ½ï¼Œå¹¶è¡Œä¸Šä¼ **: ç‹¬åˆ›çš„**å¹¶è¡Œä¸Šä¼ **æœºåˆ¶ï¼Œå°†å¤§æ–‡ä»¶åˆ‡å‰²æˆå¤šä¸ªåˆ†å·ååŒæ—¶ä¸Šä¼ ï¼Œèƒ½æ¦¨å¹²æ‚¨çš„æœåŠ¡å™¨å¸¦å®½ï¼Œå°†å¤‡ä»½æ—¶é—´**æˆå€ç¼©çŸ­**ã€‚
-   **æµå¼å¤„ç†ï¼Œé›¶ç¡¬ç›˜å ç”¨**: é‡‡ç”¨ `tar` å’Œ `split` çš„**ç®¡é“æµå¼å¤„ç†**æŠ€æœ¯ï¼Œåœ¨å‹ç¼©å’Œåˆ†å·çš„è¿‡ç¨‹ä¸­ï¼Œ**å®Œå…¨ä¸äº§ç”Ÿå·¨å¤§çš„ä¸­é—´æ–‡ä»¶**ï¼Œå¯¹ç¡¬ç›˜ç©ºé—´æå…¶å‹å¥½ã€‚
-   **æ™ºèƒ½è½®æ›¿ï¼Œç©ºé—´æ— å¿§**: å¯è‡ªå®šä¹‰ä¿ç•™æœ€æ–°çš„å¤‡ä»½â€œç»„â€ï¼ˆä¸€ä¸ªå®Œæ•´å¤‡ä»½çš„æ‰€æœ‰åˆ†å·ï¼‰ã€‚è„šæœ¬ä¼šåœ¨æ¯æ¬¡æˆåŠŸä¸Šä¼ åï¼Œè‡ªåŠ¨åˆ é™¤æœ€æ—§çš„å¤‡ä»½ç»„ï¼Œå®ç°å®Œç¾çš„å¤‡ä»½å‘¨æœŸç®¡ç†ã€‚
-   **æ— äººå€¼å®ˆï¼Œé•¿è¾¾åå¹´**: ä»…éœ€ä¸€æ¬¡æ‰‹åŠ¨æˆæƒï¼Œè„šæœ¬å³å¯åœ¨é•¿è¾¾ **10 å¹´**å†…è‡ªåŠ¨åˆ·æ–° `Token`ï¼Œæ— éœ€ä»»ä½•äººå·¥å¹²é¢„ã€‚
-   **æ•°æ®æ ¡éªŒï¼Œç¡®ä¿å¯é **: Python å¼•æ“å†…ç½®**åŒé‡ MD5 æ–‡ä»¶å®Œæ•´æ€§è‡ªæ£€**ï¼Œå¹¶åœ¨ä¸Šä¼ åç”±ç™¾åº¦æœåŠ¡å™¨è¿›è¡Œæœ€ç»ˆæ ¡éªŒï¼Œç¡®ä¿æ‚¨å¤‡ä»½çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½å‡†ç¡®æ— è¯¯ã€‚
-   **æ¸…æ™°æ¶æ„ï¼Œæ˜“äºé…ç½®**: é‡‡ç”¨**é…ç½®ä¸å¼•æ“åˆ†ç¦»**çš„ä¸“ä¸šæ¶æ„ã€‚æ‚¨åªéœ€è¦ä¿®æ”¹ `start_backup.sh` è¿™ä¸€ä¸ªæ–‡ä»¶ï¼Œå³å¯å®Œæˆæ‰€æœ‰é…ç½®ï¼ŒPython è„šæœ¬æ— éœ€ä»»ä½•æ”¹åŠ¨ã€‚
-   **é«˜å®¹é”™æ€§**: é’ˆå¯¹å¤‡ä»½â€œåŠ¨æ€ç›®å½•â€ï¼ˆå¦‚è¿è¡Œä¸­çš„ç½‘ç«™æˆ–æ¸¸æˆæœåŠ¡å™¨ï¼‰çš„åœºæ™¯ï¼Œè„šæœ¬å†…ç½®äº†å¤šç§å®¹é”™æœºåˆ¶ï¼Œç¡®ä¿åœ¨æºæ–‡ä»¶é¢‘ç¹å˜åŒ–æ—¶ï¼Œä¾ç„¶èƒ½æœ€å¤§é™åº¦åœ°æˆåŠŸåˆ›å»ºå¤‡ä»½ã€‚
-   **æ—¥å¿—æ¸…æ™°ï¼Œæ˜“äºæ’é”™**: ä¸“ä¸ºè‡ªåŠ¨åŒ–ä»»åŠ¡è®¾è®¡çš„æ—¥å¿—ç³»ç»Ÿï¼Œåœ¨å¹¶è¡Œæ¨¡å¼ä¸‹ä¹Ÿèƒ½ä¿æŒæ¸…æ™°å¯è¯»ã€‚è‹¥æ— äº‹ï¼Œåˆ™é™é»˜ï¼›è‹¥æœ‰é”™ï¼Œåˆ™è¯¦å°½ã€‚

## âš™ï¸ æ¶æ„ç®€ä»‹

Baidu-Backup ç”±ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶æ„æˆï¼Œå„å¸å…¶èŒï¼š

1.  **`start_backup.sh` (æ€»æŒ‡æŒ¥ & é…ç½®æ–‡ä»¶)**
    -   **èŒè´£**: è´Ÿè´£æ‰€æœ‰**æœ¬åœ°æ“ä½œ**å’Œ**å‚æ•°é…ç½®**ã€‚
    -   **å·¥ä½œæµ**: æµå¼å‹ç¼© -> åŠ¨æ€åˆ†å· -> **å¹¶è¡Œè°ƒåº¦** Python å¼•æ“ã€‚
    -   **æ‚¨éœ€è¦ä¿®æ”¹çš„å”¯ä¸€æ–‡ä»¶ï¼**

2.  **`111.py` (ä¸Šä¼ å¼•æ“)**
    -   **èŒè´£**: è´Ÿè´£æ‰€æœ‰**äº‘ç«¯æ“ä½œ**ã€‚
    -   **å·¥ä½œæµ**: æ¥æ”¶ Shell è„šæœ¬ä¼ é€’çš„å‚æ•° -> æœ¬åœ°æ–‡ä»¶è‡ªæ£€ -> ä¸Šä¼ åˆ†å· -> æ™ºèƒ½è½®æ›¿äº‘ç«¯å¤‡ä»½ã€‚
    -   **ä¸€ä¸ªå®Œå…¨æ— éœ€ä¿®æ”¹çš„â€œé»‘ç›’å·¥å…·â€ã€‚**

## ğŸ“– å¿«é€Ÿä¸Šæ‰‹æŒ‡å—

### ç¬¬ 1 æ­¥ï¼šè·å–ç™¾åº¦å¼€æ”¾å¹³å°å‡­è¯

1.  è®¿é—® [ç™¾åº¦ç½‘ç›˜å¼€æ”¾å¹³å°](https://pan.baidu.com/union/console) å¹¶ç™»å½•ã€‚
2.  å®Œæˆå¼€å‘è€…è®¤è¯ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªâ€œä¸ªäººåº”ç”¨-å­˜å‚¨â€ç±»å‹çš„åº”ç”¨ã€‚
3.  åœ¨åº”ç”¨è¯¦æƒ…é¡µï¼Œè®°ä¸‹æ‚¨çš„ **`AppKey`** å’Œ **`SecretKey`**ã€‚

### ç¬¬ 2 æ­¥ï¼šéƒ¨ç½²é¡¹ç›®

1.  å…‹éš†æœ¬ä»“åº“åˆ°æ‚¨çš„æœåŠ¡å™¨ï¼š
    ```bash
    git clone https://github.com/lansepeach/Baidu-Backup.git
    cd Baidu-Backup
    ```
2.  ä»å®˜ç½‘ä¸‹è½½ [Python SDK](https://pan.baidu.com/union/doc/Kl4gsu388)ï¼Œè§£å‹åå°† `openapi_client` æ–‡ä»¶å¤¹æ•´ä¸ªå¤åˆ¶åˆ° `Baidu-Backup` é¡¹ç›®ç›®å½•ä¸‹ã€‚
3.  å®‰è£…ä¾èµ–ï¼š
    ```bash
    sudo apt install python3-requests
    ```

### ç¬¬ 3 æ­¥ï¼šé…ç½® `start_backup.sh`

æ‰“å¼€ `start_backup.sh` æ–‡ä»¶ï¼Œè¿™æ˜¯æ‚¨å”¯ä¸€éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶ã€‚è¯·æ ¹æ®æ³¨é‡Šï¼Œå¡«å†™æ‚¨çš„ä¿¡æ¯ã€‚

```bash
#!/bin/bash

# --- è¯·åœ¨è¿™é‡Œé…ç½®æ‚¨çš„æ‰€æœ‰ä¿¡æ¯ ---
# 1. ç™¾åº¦å¼€æ”¾å¹³å°å‡­è¯
export BAIDU_APP_KEY="ä½ çš„AppKey"
export BAIDU_SECRET_KEY="ä½ çš„SecretKey"

# 2. æœ¬åœ°å¤‡ä»½æºç›®å½•
LIVE_DATA_DIR="/path/to/your/data/to/backup"

# 3. äº‘ç«¯å¤‡ä»½ç›®æ ‡ç›®å½•
REMOTE_DIR="/apps/ä½ çš„åº”ç”¨åç§°/server_backups"

# 4. æœ€å¤§ä¿ç•™çš„å¤‡ä»½ç»„æ•°é‡ (è®¾ç½®ä¸º 0 åˆ™ä¿ç•™æ‰€æœ‰)
MAX_BACKUPS=7 # ä¾‹å¦‚ï¼Œåªä¿ç•™æœ€è¿‘7å¤©çš„å¤‡ä»½

# 5. åˆ†å·å¤§å° (1G æ˜¯ä¸€ä¸ªéå¸¸æ¨èçš„ç¨³å¥å€¼)
SPLIT_SIZE="1G"

# 6. (ğŸš€) å¹¶è¡Œä¸Šä¼ ä»»åŠ¡æ•° (å»ºè®®ä» 2 æˆ– 3 å¼€å§‹)
PARALLEL_UPLOADS=3

# 7. Python è§£é‡Šå™¨å’Œè„šæœ¬çš„ç»å¯¹è·¯å¾„ (è¯·ç¡®è®¤ä¸ºæ‚¨æœåŠ¡å™¨ä¸Šçš„çœŸå®è·¯å¾„)
PYTHON_EXECUTABLE="/usr/bin/python3"
BACKUP_SCRIPT_PATH="/path/to/your/Baidu-Backup/Baidu-Backup.py"
# --- é…ç½®ç»“æŸ ---
```

### ç¬¬ 4 æ­¥ï¼šæˆæƒä¸è¿è¡Œ

1.  **æˆäºˆæ‰§è¡Œæƒé™**:
    ```bash
    chmod +x start_backup.sh
    ```

2.  **é¦–æ¬¡è¿è¡Œ (äº¤äº’å¼æˆæƒ)**:
    ç›´æ¥åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œï¼š
    ```bash
    ./start_backup.sh
    ```
    è„šæœ¬ä¼šæ£€æµ‹åˆ° `baidu_token.json` æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå¹¶è‡ªåŠ¨è¿›å…¥æˆæƒæµç¨‹ã€‚è¯·æ ¹æ® Python è„šæœ¬çš„æç¤ºï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ URLï¼Œå®Œæˆæˆæƒï¼Œç„¶åå°† `code` ç ç²˜è´´å›ç»ˆç«¯ã€‚
    
    æˆæƒæˆåŠŸåï¼Œå¤‡ä»½ä»»åŠ¡å°†è‡ªåŠ¨å¼€å§‹ã€‚

3.  **åç»­è¿è¡Œ (å…¨è‡ªåŠ¨)**:
    å†æ¬¡è¿è¡Œ `./start_backup.sh` æ—¶ï¼Œè„šæœ¬å°†å…¨è‡ªåŠ¨é™é»˜è¿è¡Œï¼Œæ— éœ€ä»»ä½•äº¤äº’ã€‚

### ç¬¬ 5 æ­¥ï¼šè®¾ç½®å®šæ—¶ä»»åŠ¡ (Cron Job)

å°†æ‚¨çš„å¤‡ä»½ä»»åŠ¡è‡ªåŠ¨åŒ–ï¼Œä¾‹å¦‚ï¼Œè®¾ç½®æ¯å¤©å‡Œæ™¨3ç‚¹æ‰§è¡Œï¼š

```bash
# ç¼–è¾‘ crontab
crontab -e

# æ·»åŠ ä»¥ä¸‹ä¸€è¡Œ (è¯·ç¡®ä¿ä½¿ç”¨ start_backup.sh çš„ç»å¯¹è·¯å¾„)
0 3 * * * /path/to/your/Baidu-Backup/start_backup.sh >> /var/log/baidu_backup.log 2>&1
```

## æ¢å¤å¤‡ä»½

1.  å°†å±äºåŒä¸€ä¸ªå¤‡ä»½æ‰¹æ¬¡çš„æ‰€æœ‰åˆ†å·æ–‡ä»¶ï¼ˆä¾‹å¦‚ `..._20250917-030000.tar.gz.00`, `...01`, `...02`ï¼‰ä¸‹è½½åˆ°åŒä¸€ä¸ªç›®å½•ã€‚
2.  ä½¿ç”¨ `cat` å‘½ä»¤å°†å®ƒä»¬åˆå¹¶æˆä¸€ä¸ªå®Œæ•´çš„å‹ç¼©åŒ…ï¼š
    ```bash
    cat your_backup_timestamp.tar.gz.* > complete_backup.tar.gz
    ```
3.  è§£å‹å³å¯ï¼š
    ```bash
    tar -xzf complete_backup.tar.gz
    ```

## ğŸ¤ è´¡çŒ®

å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–æ”¹è¿›å»ºè®®ï¼Œæ¬¢è¿æäº¤ [Issues](https://github.com/lansepeach/Baidu-Backup/issues) æˆ– Pull Requestsã€‚å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ä¸è¦åå•¬æ‚¨çš„ **Star** â­ï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) æˆæƒã€‚
